@let incident = this.incident();

@let users = this.users();
@let assignedUser = this.assignedUser();
@let selectedUser = this.selectedUser();

@let subjects = this.subjects();
@let tiedSubject = this.tiedSubject();
@let selectedSubject = this.selectedSubject();


<form [formGroup]="form" class="incident-form">
    <div class="page-container" *ngIf="incident as data">
        <div routerLink="/incidents/open" class="back flex-inline">
            <mat-icon>arrow_back</mat-icon> Back to List
        </div>
        <br>
        
        @if (incident) {

            <div class="title flex-inline">
                <b>{{incident.title}}</b><mat-icon>edit</mat-icon>
            </div>

            <br>
            <br>
            
            <io-status-select
                formControlName="status"
                label="Status"
                [options]="statusOptions">
            </io-status-select>
            
            <br>
            <br>

            <io-profile-picker
                formControlName="assignedUserId"
                label="Assigned User"
                [items]="users"
                idKey="userId"
                nullLabel="No Assignee">
            </io-profile-picker>

            <br>
            <br>

            <io-profile-picker
                formControlName="tiedSubjectId"
                label="Tied Subject"
                [items]="subjects"
                idKey="subjectId"
                nullLabel="No Subject">
            </io-profile-picker>

            <br>
            <br>

            *Token Section*

            <br>
            <br>

            *Activity Section*

        } @else {
            <p>incident Not Found</p>
        }

    </div>
</form>

<io-action-bar 
    [isOpen]="form.dirty" 
    (save)="onSave()" 
    (cancel)="onCancel()">
</io-action-bar>